<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Galaxy Scroll Demo</title>
  <style>
    /* Reset & basic styles */
    html,
    body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      scroll-behavior: smooth;
      font-family: sans-serif;
      height: 400vh;
      /* Enough space to scroll through 4 “screens” worth */
    }

    /* The pinned galaxy background */
    #galaxy {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      /* space is black! */
      overflow: hidden;
      /* keep the stars within this container */
      z-index: -1;
      /* ensure it sits behind everything else */
      transition: transform 1.5s ease;
      /* smooth transform changes */
      transform-style: preserve-3d;
      /* so 3D transforms (rotateX) look correct */
    }

    /* Each star is a small white dot with a twinkle animation */
    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: #fff;
      border-radius: 50%;
      animation: twinkle 2s infinite ease-in-out;
      opacity: 0.8;
    }

    @keyframes twinkle {

      0%,
      100% {
        opacity: 0.8;
      }

      50% {
        opacity: 0.2;
      }
    }

    /* Our pinned sections (fake “slides”) */
    section {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: #fff;
      pointer-events: none;
      /* so the 'scroll-spacer' behind is scrollable */
      transition: opacity 0.7s ease-in-out;
      opacity: 1;
      text-align: center;
    }

    .hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* Distinct text color or overlay for each section (optional) */
    #section1 {
      background: rgba(0, 0, 0, 0.2);
    }

    #section2 {
      background: rgba(0, 0, 0, 0.2);
    }

    #section3 {
      background: rgba(0, 0, 0, 0.2);
    }

    #section4 {
      background: rgba(0, 0, 0, 0.2);
    }

    /* The actual scrollable space behind the pinned sections */
    .scroll-spacer {
      width: 100vw;
      height: 400vh;
      /* 4 “screens” */
    }

    /* Debug box (optional) */
    #debug {
      position: fixed;
      top: 0;
      left: 0;
      padding: 0.5rem 1rem;
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
      font-size: 0.9rem;
      z-index: 9999;
    }
  </style>
</head>

<body>

  <!-- Debug readout (optional) -->
  <div id="debug">Scroll Position: 0</div>

  <!-- The pinned galaxy layer (behind sections) -->
  <div id="galaxy"></div>

  <!-- Our 4 pinned sections stacked up -->
  <section id="section1">SECTION 1<br>Far View of Galaxy</section>
  <section id="section2" class="hidden">SECTION 2<br>Tilt 30° from Section 1</section>
  <section id="section3" class="hidden">SECTION 3<br>Zoom In</section>
  <section id="section4" class="hidden">SECTION 4<br>Transition Back to Far View</section>

  <!-- Scroll spacer to enable actual scrolling -->
  <div class="scroll-spacer"></div>

  <script>
    /* ==============================
       1) GENERATE RANDOM STARS
       ============================== */
    const galaxy = document.getElementById('galaxy');

    const NUM_STARS = 200; // adjust for density
    for (let i = 0; i < NUM_STARS; i++) {
      const star = document.createElement('div');
      star.className = 'star';
      // Random position
      star.style.top = Math.random() * 100 + '%';
      star.style.left = Math.random() * 100 + '%';
      // Optional: random twinkle duration
      star.style.animationDuration = (Math.random() * 2 + 1) + 's';
      galaxy.appendChild(star);
    }

    /* ==============================
       2) SCROLL + TRANSFORM LOGIC
       ============================== */
    const debugBox = document.getElementById('debug');
    const s1 = document.getElementById('section1');
    const s2 = document.getElementById('section2');
    const s3 = document.getElementById('section3');
    const s4 = document.getElementById('section4');

    window.addEventListener('scroll', () => {
      const scrollPos = window.scrollY;
      const screenHeight = window.innerHeight;

      debugBox.textContent =
        'Scroll Position: ' + Math.round(scrollPos) +
        ' | screenHeight: ' + screenHeight;

      /* Decide which “section” is in view. 
         Then show/hide sections & apply transforms to #galaxy 
      */
      if (scrollPos < screenHeight) {
        // SECTION 1: far view, no tilt
        s1.classList.remove('hidden');
        s2.classList.add('hidden');
        s3.classList.add('hidden');
        s4.classList.add('hidden');

        // transform: normal scale, no rotation
        galaxy.style.transform = 'scale(1) rotateX(0deg)';
      }
      else if (scrollPos >= screenHeight && scrollPos < 2 * screenHeight) {
        // SECTION 2: tilt 30 degrees
        s1.classList.add('hidden');
        s2.classList.remove('hidden');
        s3.classList.add('hidden');
        s4.classList.add('hidden');

        // transform: slight scale, 30° tilt
        galaxy.style.transform = 'perspective(1000px) rotateX(20deg) scale(1.5)';
      }
      else if (scrollPos >= 2 * screenHeight && scrollPos < 3 * screenHeight) {
        // SECTION 3: zoom in more
        s1.classList.add('hidden');
        s2.classList.add('hidden');
        s3.classList.remove('hidden');
        s4.classList.add('hidden');

        // transform: deeper scale, keep tilt
        galaxy.style.transform = 'perspective(1000px) rotateX(20deg) scale(2)';
      }
      else {
        // SECTION 4: return to far view
        s1.classList.add('hidden');
        s2.classList.add('hidden');
        s3.classList.add('hidden');
        s4.classList.remove('hidden');

        // transform: back to normal scale, no tilt
        galaxy.style.transform = 'scale(1) rotateX(0deg)';
      }
    });
  </script>
</body>

</html>